# 更新日誌

## 版本 2.0.0 - 2026-01-04

### 新增功能

#### 1. 股票名稱顯示 ✅
- 自動透過 Fugle API 查詢股票中文名稱
- 在股票代碼旁顯示公司名稱（例如：2330 台積電）
- 首次載入時自動抓取所有持股的名稱

#### 2. 編輯功能 ✅
- 每張股票卡片新增「編輯」按鈕
- 可直接修改買價和張數
- 編輯時顯示儲存（✓）和取消（✕）按鈕
- 修改後自動重新計算損益並同步至雲端

#### 3. 排序功能 ✅
- 新增排序下拉選單，支援四種排序方式：
  - **依時間排序**：按新增順序（預設）
  - **依損益排序**：由高到低排列
  - **依報酬率排序**：由高到低排列
  - **依代碼排序**：按股票代碼字母順序

#### 4. 錯誤處理與載入狀態 ✅
- **載入畫面**：首次開啟時顯示旋轉載入動畫
- **錯誤提示**：WebSocket 斷線或同步失敗時顯示紅色警告橫幅
- **可關閉錯誤**：點擊 ✕ 按鈕可關閉錯誤提示
- **友善錯誤訊息**：顯示具體的錯誤原因

#### 5. 手續費折數自訂 ✅
- 新增「⚙️ 設定」按鈕
- 可自訂券商折數（預設 23 折）
- 可自訂最低手續費（預設 20 元）
- 設定會同步至雲端，所有裝置共用

#### 6. 損益高低點追蹤 ✅
- **即時追蹤**：每檔股票自動記錄最高和最低損益點
- **時間戳記**：記錄達到高低點的精確時間
- **視覺化顯示**：
  - 📈 最高損益（紅色）
  - 📉 最低損益（綠色）
- **格式化時間**：顯示為「月/日 時:分」格式

### 技術改進

- 優化資料結構：新增 `highPoint` 和 `lowPoint` 欄位
- 改進 WebSocket 錯誤處理機制
- 新增 CSS 動畫支援（載入旋轉動畫）
- 設定資料與股票資料分離儲存
- 使用 Firestore merge 模式避免覆蓋資料

### 使用者介面優化

- 新增設定面板（可展開/收合）
- 改進按鈕佈局（編輯和刪除並排）
- 新增高低點資訊區塊（深色背景區分）
- 優化錯誤提示樣式（紅色橫幅 + 關閉按鈕）
- 改進載入畫面視覺效果

### 資料遷移

現有使用者的資料會自動相容，新欄位會在下次更新價格時自動初始化：
- `name`: 空字串（首次載入時自動查詢）
- `highPoint`: 初始化為當前損益
- `lowPoint`: 初始化為當前損益
- `config`: 使用預設值（可透過設定修改）

### 已知限制

- 股票名稱查詢依賴 Fugle API，若 API 失敗則不顯示名稱
- 高低點記錄僅追蹤本次開啟後的資料，不包含歷史極值
- 設定變更後需手動點擊「儲存」才會生效

### 下一步計畫

- 歷史紀錄功能（記錄所有交易）
- 匯出功能（CSV/Excel）
- 圖表視覺化（損益曲線圖）
- 價格警示推播
